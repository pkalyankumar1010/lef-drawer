(()=>{"use strict";var e={4:function(e,t,i){var s,o=this&&this.__createBinding||(Object.create?function(e,t,i,s){void 0===s&&(s=i);var o=Object.getOwnPropertyDescriptor(t,i);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,s,o)}:function(e,t,i,s){void 0===s&&(s=i),e[s]=t[i]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||(s=function(e){return s=Object.getOwnPropertyNames||function(e){var t=[];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[t.length]=i);return t},s(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i=s(e),r=0;r<i.length;r++)"default"!==i[r]&&o(t,e,i[r]);return n(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.activate=function(e){console.log('Congratulations, your extension "lef-viz" is now active in the web extension host!');const t=a.commands.registerCommand("lef-viz.helloWorld",()=>{a.window.showInformationMessage("Hello World from lef-viz in a web extension host!")});e.subscriptions.push(t);const i=a.commands.registerCommand("lef-viz.showPreview",async()=>{const t=a.window.activeTextEditor;if(!t)return void a.window.showErrorMessage("No LEF file open");const i=a.window.createWebviewPanel("lefPreview","LEF Preview",a.ViewColumn.Beside,{enableScripts:!0,localResourceRoots:[a.Uri.joinPath(e.extensionUri,"react-dist")]}),s=i.webview.asWebviewUri(a.Uri.joinPath(e.extensionUri,"react-dist","assets","index-CKnCRv9t.js")),o=i.webview.asWebviewUri(a.Uri.joinPath(e.extensionUri,"react-dist","assets","index-B2X0Co8W.css")),n=i.webview.asWebviewUri(a.Uri.joinPath(e.extensionUri,"react-dist","vite.svg")),r=a.Uri.joinPath(e.extensionUri,"react-dist","index.html"),c=await fetch(r.toString());let d=await c.text();d=d.replace("/assets/index-CKnCRv9t.js",s.toString()),d=d.replace("/assets/index-B2X0Co8W.css",o.toString()),d=d.replace("/vite.svg",n.toString()),i.webview.html=d;let u=!1;i.webview.onDidReceiveMessage(e=>{switch(console.log("Received message from webview:",e),e.command){case"webview-ready":console.log("Webview is ready, sending initial data"),u=!0,v();break;case"log":console.log("Webview log:",e.text);break;default:console.log("Unknown message from webview:",e)}},void 0,e.subscriptions);const v=()=>{if(!u)return void console.log("Webview not ready yet, skipping data send");const e=t.document.getText(),s=(0,l.parseLef)(e),o={type:"lef-data",data:s.vias,parsedData:s.vias};i.webview.postMessage(o),console.log("Sent LEF data to webview:",o)},p=a.workspace.onDidChangeTextDocument(e=>{e.document===t.document&&(console.log("Editor content changed, updating webview"),v())});i.onDidDispose(()=>{p.dispose()},null,e.subscriptions),setTimeout(()=>{u||(console.log("Webview not ready after timeout, sending data anyway"),u=!0,v())},1e3),setTimeout(()=>{v()},500)});e.subscriptions.push(i)},t.deactivate=function(){};const a=r(i(1398)),l=i(5138)},1398:e=>{e.exports=require("vscode")},5138:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseLef=function(e){const t=e.split(/\r?\n/),i=[],s=[];let o={},n={},r=[],a=!1;for(const e of t){const t=e.trim();if(t.startsWith("LAYER")&&!a)o={name:t.split(" ")[1]};else if(t.startsWith("TYPE")&&!a)o.type=t.split(" ")[1].replace(";","");else if(t.startsWith("WIDTH")&&!a)o.width=parseFloat(t.split(" ")[1]);else if(t.startsWith("SPACING")&&!a)o.spacing=parseFloat(t.split(" ")[1]);else if(t.startsWith("VIA"))n={name:t.split(" ")[1]},r=[],a=!0;else if(a&&t.startsWith("LAYER")){const e=t.split(" ")[1];r.push({layer:e,rects:[]})}else if(a&&t.startsWith("RECT")){const e=t.match(/[-+]?\d*\.?\d+/g),i=e?e.map(parseFloat):[];r.length>0&&r[r.length-1].rects.push(i)}else if(t.startsWith("END")){const e=t.split(" ")[1];a||o.name!==e?a&&n.name===e&&(n.layers=r,s.push(n),n={},r=[],a=!1):(i.push(o),o={})}}return{layers:i,vias:s}}}},t={},i=function i(s){var o=t[s];if(void 0!==o)return o.exports;var n=t[s]={exports:{}};return e[s].call(n.exports,n,n.exports,i),n.exports}(4),s=exports;for(var o in i)s[o]=i[o];i.__esModule&&Object.defineProperty(s,"__esModule",{value:!0})})();